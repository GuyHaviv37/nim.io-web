var G=Object.defineProperty,H=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var k=(s,t,a)=>t in s?G(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))A.call(t,a)&&k(s,a,t[a]);if(C)for(var a of C(t))L.call(t,a)&&k(s,a,t[a]);return s},I=(s,t)=>H(s,$(t));import{j as O,P as U,G as j,r as i,L as F,R as b,C as B,v as D,a as V,X as T,l as Q,u as Y,b as z,c as _,d as W,e as S,f as X,B as q}from"./vendor.89ab4a27.js";const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}};J();const e=O.exports.jsx,c=O.exports.jsxs,Z="h-20 w-20 text-slate-800 xl:h-28 xl:w-28",K=s=>{if(s==="pencil")return e(U,{className:"h-20 w-20 text-slate-800 xl:h-28 xl:w-28"});if(s==="globe")return e(j,{className:Z})},P=s=>{const{title:t,subtitle:a,icon:n,children:o}=s;return c("div",{className:"bg-indigo-200 rounded flex flex-col items-center space-y-3 pt-3 pb-5 lg:max-w-lg lg:justify-self-center lg:w-full xl:max-w-3xl",children:[K(n),e("h2",{className:"text-slate-800 text-2xl tracking-wider font-semibold lg:text-3xl xl:text-4xl",children:t}),e("h6",{className:"text-slate-800 text-md lg:text-lg xl:text-xl",children:a}),o]})},ee="https://nim-io-server.herokuapp.com/",te="https://guyhaviv37.github.io/nim.io-web/",se={id:"",heaps:[],originalHeaps:[],player1:null,player2:null,playersConnected:0,currentPlayerTurn:"",isPlayer1Ready:!1,isPlayer2Ready:!1},y=25,v=s=>{const{name:t,value:a,setValue:n,maxValue:o}=s,l=o!=null?o:y,r=i.exports.useCallback(d=>{const m=Number.isNaN(parseInt(d.target.value))?1:parseInt(d.target.value);n(m)},[n]);return i.exports.useEffect(()=>{a>l&&n(Math.max(1,l))},[o]),c("div",{className:"flex xl:h-8",children:[e("button",{className:"bg-gray-100 px-1.5 rounded-l focus:outline-indigo-700 focus:outline-offset-0 hover:bg-gray-200 hover:text-black xl:px-3",onClick:()=>n(Math.max(1,a-1)),children:e("span",{className:"m-auto font-thin",children:"-"})}),e("input",{className:"outline-none bg-gray-100 text-center w-8 focus:outline-none",type:"number",min:"1",max:l,name:t,value:a,onChange:r}),e("button",{className:"px-1.5 bg-gray-100 rounded-r focus:outline-indigo-700 focus:outline-offset-0 hover:bg-gray-200 hover:text-black xl:px-3",onClick:()=>n(Math.min(l,a+1)),children:e("span",{className:"m-auto font-thin text-center",children:"+"})})]})},N=({label:s,onPress:t,disabled:a})=>e("button",{disabled:a,className:`py-1 px-2 rounded tracking-wide text-sm text-gray-100  ${a?"bg-slate-400":"bg-indigo-500"}
            shadow-md transform transition focus:outline-none focus:ring-2 focus:ring-indigo-700 focus:ring-offset-1
            ${a?"":"hover:-translate-y-0.5 hover:bg-indigo-700 hover:text-white active:translate-y-0"}
            lg:py-2 lg:px-4 lg:text-md lg:tracking-wide lg:shadow-lg
            xl:py-2.5 xl:px-5 xl:tracking-wider`,onClick:t,children:s}),E=s=>{const{label:t,pathname:a,state:n}=s;return e(F,{to:a,state:n,className:"outline-none focus:outline-none",children:e(N,{label:t})})},ae=s=>{const{value:t,onChange:a}=s;return e("input",{className:"rounded bg-gray-100 text-slate-800 placeholder:text-slate-400 px-2 w-40 focus:outline-none focus:ring-2 focus:ring-indigo-700 focus:ring-offset-1",type:"text",placeholder:"Game ID",value:t,onChange:a})},ne=()=>{const[s,t]=i.exports.useState(!1);return c("div",{className:"flex flex-col bg-gray-100 py-5 px-10 text-center",children:[c("div",{className:"flex items-center justify-center space-x-4 cursor-pointer",onClick:()=>{t(n=>!n)},children:[e(B,{className:`w-6 h-6 transform ${s?"rotate-90":"rotate-0"}`}),e("h5",{className:"text-lg font-semibold tracking-wide xl:text-xl",children:"How To Play ?"})]}),s&&c("ul",{className:"px-10 pt-2 text-sm text-left md:text-center md:text-base md:font-thin xl:text-lg",children:[c("li",{children:[e("a",{className:"underline text-blue-600 font-semibold",href:"https://en.wikipedia.org/wiki/Nim",target:"_blank",children:"Nim"})," is a 2-player, turn-based, mathematical game of strategy."]}),e("li",{children:"The game starts with 3 heaps with some number of blocks (1-25)."}),e("li",{children:"Each player, in his turn, selects to remove some blocks."}),c("li",{children:["He must remove ",e("strong",{children:"at least one block"})," at his turn, from a ",e("strong",{children:"single"})," heap."]}),c("li",{children:["The player which removes the ",e("strong",{children:"LAST"})," block in all of the heaps - wins the game !"]})]})]})};var re=b.memo(ne);const oe=()=>D().substring(0,8),le=()=>{const[s,t]=i.exports.useState(1),[a,n]=i.exports.useState(1),[o,l]=i.exports.useState(1),[r,d]=i.exports.useState(""),m=i.exports.useCallback(u=>{d(u.target.value)},[d]);return c("main",{className:"pt-5",children:[e("h2",{className:"font-semibold text-4xl text-center tracking-wide text-indigo-500",children:"Nim.io"}),e("div",{className:"mt-9 px-10",children:c("div",{className:"grid grid-rows-2 space-y-3 sm:grid-rows-1 sm:grid-cols-2 sm:space-x-2 sm:space-y-0 md:space-x-3",children:[c(P,{title:"Create Game",subtitle:"Choose heap sizes:",icon:"pencil",children:[c("div",{className:"flex space-x-3 mb-10 xl:space-x-5",children:[e(v,{name:"heapA",value:s,setValue:t}),e(v,{name:"heapB",value:a,setValue:n}),e(v,{name:"heapC",value:o,setValue:l})]}),e(E,{label:"Create",pathname:`/game/${oe()}/1`,state:{heaps:[s,a,o]}})]}),c(P,{title:"Join Game",subtitle:"Enter game id:",icon:"globe",children:[e(ae,{value:r,onChange:m}),e(E,{label:"Join",pathname:r?`/game/${r}/2`:"/"})]})]})}),e(re,{})]})};var ie=b.memo(le);const ce=s=>s?"bg-indigo-400 flex flex-row-reverse":"bg-gray-200",de=s=>{const{isPlayerReady:t,isOpponentReady:a,isOpponentConnected:n,toggleReady:o,inviteUrl:l}=s,[r,d]=i.exports.useState(!1),m=i.exports.useCallback(()=>{r||(d(!0),setTimeout(()=>d(!1),2100)),navigator.clipboard.writeText(l)},[r,d]);return c("div",{children:[c("div",{className:"bg-indigo-200 rounded flex flex-col mx-auto items-center space-y-3 pt-3 pb-5 max-w-3xl",children:[e("h4",{className:"text-slate-800 text-lg tracking-wider font-semibold lg:text-xl xl:text-3xl",children:"Players are getting ready..."}),c("div",{className:"grid grid-cols-2 grid-rows-2 place-items-center",children:[e("p",{className:"xl:text-lg",children:"Opponent: "}),n?e("div",{children:a?e(V,{className:"h-7 w-7 text-emerald-500 lg:h-8 lg:w-8"}):e(T,{className:"h-7 w-7 text-rose-600 lg:h-8 lg:w-8"})}):e("div",{className:"animate-spin w-7 h-7 border-4 rounded-full border-r-transparent lg:h-8 lg:w-8"}),e("p",{className:"xl:text-lg",children:"You: "}),e("div",{className:`h-5 w-11 rounded-lg shadow-sm ${ce(t)}`,children:e("button",{className:"w-5 h-5 transfrom scale-105 rounded-full bg-white shadow-sm",onClick:()=>o()})})]})]}),!n&&c("div",{className:"mt-7 flex flex-col items-center",children:[e(N,{label:"Invite Friend",onPress:m}),e("p",{className:`opacity-0 text-center mt-3 px-2 py-1 text-slate-800 text-sm
                    lg:text-md
                    border-2 rounded-full border-slate-400 
                    ${r?"animate-fade":""}`,children:"Link to join was copied to your clipboard"})]})]})};var me=b.memo(de);const ue=s=>{const t=[];for(let a=0;a<y;a++){const n=a>=y-s;t.push(e("div",{className:`rounded
            sm:w-5 sm:h-5
            md:w-6 md:h-6
            lg:w-7 lg:h-7 
            ${n?"bg-blue-500":""}`,children:e("p",{className:"text-xs text-center lg:font-thin leading-[inherit] md:text-sm lg:text-lg",children:a===0&&s})},`${n?`filled_${a}`:`empty_${a}`}`))}return t},pe=s=>{const t=[],a=5-Math.ceil(s/5);for(let n=0;n<y/5;n++){const o=n>=a;t.push(e("div",{className:`
            ${o?"bg-blue-500":""}
            ${n===a?"rounded-t":""}
            ${n===4?"rounded-b":""} `},`row_$${n}`))}return t},R=s=>{const{blocks:t,selectHeap:a,isSelected:n}=s;return c("div",{className:"flex flex-col",children:[e("div",{className:"hidden border-2 border-cyan-700 rounded sm:grid sm:grid-cols-5 sm:grid-rows-5 sm:gap-1 sm:p-1",onClick:a,children:ue(t)}),c("div",{className:"relative sm:hidden sm:border-2 border-cyan-700 rounded h-16 w-16 z-10 grid grid-rows-5",onClick:a,children:[e("p",{className:"absolute top-0 left-1 text-sm z-10",children:t}),pe(t)]}),e("div",{className:`${n?"opacity-1":"opacity-0"} mt-1 h-0.5 sm:h-1 rounded bg-red-600`})]})},he=s=>{const{heaps:t,submitMove:a,isTurn:n}=s,[o,l]=i.exports.useState(),[r,d]=i.exports.useState(1),m=i.exports.useCallback(()=>{a(o,r)},[o,r,a]);return e("div",{children:c("div",{className:"bg-indigo-200 rounded flex flex-col mx-auto items-center space-y-3 pt-3 pb-5 max-w-3xl",children:[c("div",{className:"flex space-x-3",children:[e(R,{blocks:t[0],selectHeap:()=>l(0),isSelected:o===0}),e(R,{blocks:t[1],selectHeap:()=>l(1),isSelected:o===1}),e(R,{blocks:t[2],selectHeap:()=>l(2),isSelected:o===2})]}),e(v,{name:"amountToRemove",value:r,setValue:d,maxValue:o!==void 0?t[o]:y}),e(N,{label:"Submit",onPress:m,disabled:!n})]})})};function xe(s,t,a,n,o){const[l,r]=i.exports.useState(a),[d,m]=i.exports.useState(se),[u,g]=i.exports.useState();return i.exports.useEffect(()=>{l===1?s.emit("newGame",{roomId:t,heaps:o},n):l===2&&s.emit("joinGame",{roomId:t},n)},[t,l]),i.exports.useEffect(()=>(s.on("init",({newGame:p})=>{m(h=>x(x({},h),p))}),s.on("roleUpdate",({userRole:p})=>{r(p)}),()=>{s.disconnect()}),[m]),i.exports.useEffect(()=>{s.on("gameUpdate",({update:p,isRestart:h})=>{h&&g(void 0),console.log("update: ",p),m(w=>x(x({},w),p))})},[m]),i.exports.useEffect(()=>{s.on("gameOver",({winner:p})=>{m(h=>I(x({},h),{heaps:[0,0,0]})),g(p)})},[m]),{playerNo:l,game:d,winnerId:u}}const ge=s=>{const{isWinner:t,restartGame:a}=s;return c("div",{className:"mt-9 mx-auto w-1/2 rounded bg-indigo-300 max-w-md flex flex-col justify-center items-center px-2 py-4",children:[e("h4",{className:"text-center text-lg lg:text-2xl xl:text-3xl tracking-wide font-semibold",children:t?"You won!":"You lost.."}),e("br",{}),e(N,{label:"Restart Game",onPress:a})]})},fe=({errorCallback:s})=>{const t=i.exports.useMemo(()=>Q(ee),[]),{state:a}=Y(),{gameId:n="1",playerId:o="0"}=z(),{playerNo:l,game:r,winnerId:d}=xe(t,n,parseInt(o),s,a==null?void 0:a.heaps),m=_(),u=r.isPlayer1Ready&&r.isPlayer2Ready,g=l===1?r.player1:r.player2,p=i.exports.useCallback(()=>{let f=!1;l===1&&(f=!r.isPlayer1Ready),l===2&&(f=!r.isPlayer2Ready),t.emit("toggleReady",{isReady:f},s)},[l,r.isPlayer1Ready,r.isPlayer2Ready]),h=i.exports.useCallback((f,M)=>{t.emit("gameMove",{heapIndex:f,amount:M},s)},[]),w=i.exports.useCallback(()=>{t.emit("restartGame",{roomId:n},s)},[n]);return c("div",{className:"pt-5",children:[e("h2",{className:"font-semibold text-4xl text-center tracking-wide text-indigo-500 cursor-pointer",onClick:()=>m("/"),children:"Nim.io"}),d===void 0?e("div",{className:"mt-9 px-10",children:u?e(he,{heaps:r.heaps,submitMove:h,isTurn:r.currentPlayerTurn===g}):e(me,{toggleReady:p,isPlayerReady:l===1?r.isPlayer1Ready:r.isPlayer2Ready,isOpponentConnected:l===1?r.player2:r.player1,isOpponentReady:l===1?r.isPlayer2Ready:r.isPlayer1Ready,inviteUrl:`${te}/game/${n}/2`})}):e(ge,{isWinner:d===g,restartGame:w})]})};var ye=b.memo(fe);const be=5e3,ve=()=>{const[s,t]=i.exports.useState([]),a=_(),n=i.exports.useCallback(r=>{const d=setTimeout(()=>{t(u=>u.slice(1))},be),m=I(x({},r),{timeoutId:d});t(u=>[...u,m])},[t]),o=i.exports.useCallback((r,d)=>{const m=r.filter(u=>u.timeoutId!==d.timeoutId);t(m)},[t]);return{errorCallback:r=>{if(!r)return;switch(r.type){case"INAVLID_HEAPS_SIZES":case"FULL_ROOM":case"ROOM_NOT_FOUND":console.error("useErrors: ",r.msg),n(r),a("/");break;case"NO_USER_FOUND":case"USER_NOT_IN_ROOM":case"NOT_ENOUGH_PLAYERS":case"USER_WITHOUT_ROOM":case"NOT_PLAYER_TURN":case"INVALID_HEAP_INDEX":case"INVALID_AMOUNT_TO_REMOVE":n(r),console.error("useErrors: ",r.msg);default:console.error("Unknown Error: ",r)}},errorsQueue:s,removeFromQueue:o}},Ne=s=>{const{errorsQueue:t,removeFromQueue:a}=s;return e("div",{className:"absolute bottom-3 left-1/2 transform -translate-x-1/2 sm:bottom-10 md:bottom-24",children:e("div",{className:"flex flex-col justify-center",children:t.map(n=>c("div",{className:"relative z-10 bg-red-400 border-2 border-red-500 rounded my-1 py-1 text-center text-sm italic animate-fadeLonger",children:[e(T,{className:"absolute -top-1 -left-2 w-5 h-5 bg-gray-300 rounded-[50%] text-gray-700 cursor-pointer focus:outline-none",onClick:()=>a(t,n)}),e("p",{className:"p-2",children:n.msg})]},n.timeoutId))})})},we=()=>{const{errorCallback:s,errorsQueue:t,removeFromQueue:a}=ve();return c("div",{className:"bg-gray-100 h-screen w-screen",children:[c(W,{children:[e(S,{path:"/",element:e(ie,{})}),e(S,{path:"/game/:gameId/:playerId",element:e(ye,{errorCallback:s})})]}),e(Ne,{errorsQueue:t,removeFromQueue:a})]})};X.render(e(b.StrictMode,{children:e(q,{basename:"/nim.io-web",children:e(we,{})})}),document.getElementById("root"));
